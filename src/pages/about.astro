---
import Layout from "../layouts/Layout.astro"
import LatestPosts from "../components/posts/LatestPosts.astro"
import Hero from "../components/hero/Hero.astro"
import AboutSection from "../components/about/AboutSection.astro"
import TextBlock from "../components/text_block/TextBlock.astro"
import {
  fetchAccordianData,
  fetchLatestPosts,
} from "../../js/utils/supabase_methods"

// ✅ Fetch data only once here
const accordianData = await fetchAccordianData()
const latestPostsData = await fetchLatestPosts()

// Log to verify data
console.log("Latest posts data:", latestPostsData)
---

<Layout title="Home">
  <!-- Hero Section -->
  <Hero
    src="/images/landing_hero/landing_hero_bg.webp"
    alt="landing hero image"
    headerText="Victor Schweitz"
    heroParagraphText="The author of World Wide Web Development"
    hasOverlay={true}
  />

  <!-- About Section -->
  <div class="flex flex-col md:flex-row md:justify-between">
    <div class="space-y-6 mt-8 md:w-1/2">
      <TextBlock
        hasHeader={true}
        headerText="Who am I?"
        textBlockParagraphText="I’m Victor Schweitz, a 25-year-old born in the US to Danish parents—which means I’m lucky enough to call both countries home. I grew up in Denmark with my mom, dad, and my younger sister, who’s 23."
      />

      <TextBlock
        hasHeader={true}
        headerText="Development"
        textBlockParagraphText="My journey into web development began in 2017, about three-quarters of the way through my first year of high school. I stumbled across a newspaper article about a book called 'How To Code', bought it the next day—and I was hooked. That spark led me to start a computer science degree, which I later swapped for multimedia design when I realized how important the graphical side was to me. I graduated in the Summer of 2025."
      />

      <TextBlock
        hasHeader={true}
        headerText="Writing"
        textBlockParagraphText="Back in the summer of 2021, I began publishing technical articles on various web development topics—sharing tips, experiments, and lessons learned. This page is my space to collect and showcase them in one place - all for you to read and enjoy."
      />
    </div>
    <AboutSection accordianData={accordianData} />
  </div>

  <!-- Latest Posts Section -->
  <LatestPosts
    headerText="Latest Posts"
    isTextBlockHeader={true}
    latestPosts={latestPostsData}
    class="mt-4"
  />
</Layout>
